# =============================================================================
# .tmux.conf - .screenrc から変換した設定
# =============================================================================

# -----------------------------------------------------------------------------
# 基本設定
# -----------------------------------------------------------------------------

# プレフィックスキーを C-t に変更 (screenの escape ^t^t に対応)
set -g prefix C-t
unbind C-b
bind C-t send-prefix

# visual bell を無効化 (vbell off)
set -g visual-bell off

# 256色対応 (term xterm-256color)
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# スクロールバッファ行数 (defscrollback 1000)
set -g history-limit 1000

# ログインシェルを使用 (shell -$SHELL)
set -g default-command "${SHELL}"

# -----------------------------------------------------------------------------
# キーバインド
# -----------------------------------------------------------------------------

# 'a' でウィンドウタイトル変更 (bind a title)
bind a command-prompt -I "#W" "rename-window '%%'"

# screenと同様のキーバインド追加
bind c new-window           # 新しいウィンドウを作成
bind C-c new-window
bind n next-window          # 次のウィンドウへ
bind C-n next-window
bind p previous-window      # 前のウィンドウへ
bind C-p previous-window
bind k confirm-before -p "kill-window #W? (y/n)" kill-window  # ウィンドウを閉じる
bind d detach               # デタッチ
bind C-d detach
bind w choose-window        # ウィンドウ一覧

# ペイン分割
bind 2 split-window -h      # 左右にペインが並ぶ
bind 3 split-window -v      # 上下にペインが並ぶ
bind o select-pane -t :.+   # 次のペインへ移動
bind 1 kill-pane -a         # 現在のペイン以外を閉じる (only)
bind 0 kill-pane            # 現在のペインを閉じる (remove)

# -----------------------------------------------------------------------------
# ステータスバー設定 (hardstatus alwayslastline に対応)
# 元: "[%02c] %-w%{=b bw}%n %t%{-}%+w %=(%l) "
# -----------------------------------------------------------------------------

set -g status on
set -g status-interval 1
set -g status-position bottom

# ステータスバーの色設定
set -g status-style "bg=default,fg=white"

# 左側: 時刻表示 [HH:MM]
set -g status-left "[%H:%M] "
set -g status-left-length 10

# 右側: ロードアベレージ
set -g status-right " (#(sysctl -n vm.loadavg | cut -d' ' -f2-4)) "
set -g status-right-length 30

# ウィンドウリスト (中央)
set -g window-status-format "#I:#W"
set -g window-status-current-format "#I:#W"
set -g window-status-current-style "bg=blue,fg=white,bold"
set -g window-status-separator " "

# -----------------------------------------------------------------------------
# その他の設定
# -----------------------------------------------------------------------------

# ウィンドウ番号を1から開始
# set -g base-index 1
# setw -g pane-base-index 1

# ウィンドウを閉じた時に番号を詰める
set -g renumber-windows on

# エスケープキーの遅延をなくす
set -sg escape-time 0

# マウス操作を有効化
set -g mouse on
